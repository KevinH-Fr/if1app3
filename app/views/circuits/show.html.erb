 <% provide :head_tags do %>
    <script>
    document.addEventListener("DOMContentLoaded", function(){
        initMap(<%=@circuit.latitude%>, <%=@circuit.longitude%>)
    });
    </script>
<% end %>
 
 <% if user_signed_in? %>

  <br>

    <%= render @circuit %>

    <%= image_tag(@circuit.drapeau, style: "width: 100px; display: block", class: "img-fluid rounded") if @circuit.drapeau.attached? %>
      <br/><hr/><br/>
    <%= image_tag(@circuit.carte, style: "width: 100px; display: block", class: "img-fluid rounded") if @circuit.carte.attached? %>

<hr>


<%#= image_tag "https://maps.googleapis.com/maps/api/staticmap?zoom=15&size=400x300&center=#{@circuit.latitude},#{@circuit.longitude}&key=#{ENV['MAPS_API_KEY1']}", alt: "Map" %>
<%#= javascript_import_module_tag 'map' %>
<%#= javascript_include_tag "https://maps.googleapis.com/maps/api/js?key=#{ENV['MAPS_API_KEY1']}&callback=initMap",
    defer: true %>


<iframe style="border: 0;" src="https://www.google.com/maps/embed/v1/search?key=<%= ENV["MAPS_API_KEY2"] %> 
    &q=<%= @circuit.nom %>
    &zoom=14&maptype=satellite" width="90%" height="300" frameborder="0" allowfullscreen="allowfullscreen">
</iframe>

<br>

<div>

  <% if @data["weather"].present?  %>
    <p> <%= Date.today.strftime('%A, %B %d') %> </p>
     <img src="https://openweathermap.org/img/wn/<%= @data["weather"].first["icon"]%>@2x.png" />
     <p> <%= @data["weather"].first["main"] %></p>
     <p> <%= @data["weather"].first["description"] %></p>
     <p> <%= @data["main"]["temp"] %> Â° C</p>
  <% end %>
</div>


<hr>

    <div>
     <%= link_to "", circuits_path, class:"fa-solid fa-arrow-rotate-left btn btn-secondary" %>
         <br/> <br/>
    <% if current_user.admin? %>
      <table>
        <tr>
          <td>
            <%= link_to "", edit_circuit_path(@circuit), class:"fa-regular fa-pen-to-square btn btn-primary" %>
          </td>
          <td> | </td>
          <td>
          <%= button_to "", @circuit, class:"fa-solid fa-trash-can btn btn-danger", method: :delete %>
          </td>
        </tr>
      </table>
    <% end %>
<% else %>
  <br/>
  <strong>Vous n'avez pas les droits...</strong>
<% end %>