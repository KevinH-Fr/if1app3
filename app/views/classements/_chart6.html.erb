

 <% @saisonId = params[:saisonId] %>
 <% @divisionId = Event.find(@eventId).division_id %> 
 <% @eventNum = Event.find(@eventId).numero %>
  <% @numGp = Event.find(@eventId).numero  %>

<% @labels = Event.joins(:circuit).where(saison_id: @saisonId, division_id: @divisionId).pluck(:numero)  %> 
<%= @labels %>

<% @labelsCircuit =  Event.joins(:circuit).where(saison_id: @saisonId, division_id: @divisionId).pluck(:circuit_id) %> 
<%= @labelsCircuit %>



<% @piloteId1 = 5 %>
<% @piloteId2 = 6 %>

<% @piloteNom1 = Pilote.find(@piloteId1).nom %>
<% @piloteNom2 = Pilote.find(@piloteId2).nom %>

<%# permet d'avoir les resultats du pilote 5 a chaque gp sans somme %>
<% @data1 = Resultat.where(pilote_id: @piloteId1).division_courant(@divisionId).saison_courant(@saisonId).numero_until_courant(@numGp).pluck(:score) %> 
<% @data2 = Resultat.where(pilote_id: @piloteId2).division_courant(@divisionId).saison_courant(@saisonId).numero_until_courant(@numGp).pluck(:score) %> 



<%# data = Resultat.where(pilote_id: 5).count %>

<%# cumul resultat fonctionne %>
<br>
cumul :
<%= @cumulData1 = @data1.inject([]) { |x, y| x + [(x.last || 0) + y] } %>
<%= @cumulData2 = @data2.inject([]) { |x, y| x + [(x.last || 0) + y] } %>

 <br>
<%# essayer obtenir le classement donc avec sum gp apres gp 
  attendu : 1, 26, 30, 48
%>

<%#= @data = Classement.where(pilote_id: 5).select(:event_id, :score) %>
<%#= @data = @data.sort_by(&:event_id) %>
<%#= @data = @data[0].event_id %>

<div class="chart-container" style="position: relative; height:80%; width:80%">
    <canvas id="myChartPie"></canvas>
</div>

<script>

var labels = <%= @labels %>;
var data1 = <%= @cumulData1 %>;
var data2 = <%= @cumulData2 %>;

const ctx = document.getElementById('myChartPie').getContext('2d');
const myChart = new Chart(ctx, {
   type: 'line',
    data: {
        labels: labels,
        datasets: [
            {
          label: "<%= @piloteNom1 %>",
          /* label: '# of Votes', */
            data: data1,
        
  },
   {
          label: "<%= @piloteNom2 %>",
          /* label: '# of Votes', */
            data: data2,
        
  },
  
  ]
  

    },
    options: {
        scales: {
            y: {
                beginAtZero: true
            }
        }
    }
});
</script>

<script>
  const myChart = new Chart(
    document.getElementById('myChartPie'),
    config
  );
</script>